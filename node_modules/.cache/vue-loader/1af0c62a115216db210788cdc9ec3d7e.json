{"remainingRequest":"/home/pi/homer/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/pi/homer/src/components/services/UptimeKuma.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/pi/homer/src/components/services/UptimeKuma.vue","mtime":1654015932568},{"path":"/home/pi/homer/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/pi/homer/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/pi/homer/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/pi/homer/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/pi/homer/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBzZXJ2aWNlIGZyb20gIkAvbWl4aW5zL3NlcnZpY2UuanMiOwppbXBvcnQgR2VuZXJpYyBmcm9tICIuL0dlbmVyaWMudnVlIjsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiVXB0aW1lS3VtYSIsCiAgbWl4aW5zOiBbc2VydmljZV0sCiAgcHJvcHM6IHsKICAgIGl0ZW06IE9iamVjdCwKICB9LAogIGNvbXBvbmVudHM6IHsKICAgIEdlbmVyaWMsCiAgfSwKICBkYXRhOiAoKSA9PiAoewogICAgaW5jaWRlbnQ6IG51bGwsCiAgICBoZWFydGJlYXQ6IG51bGwsCiAgfSksCiAgY29tcHV0ZWQ6IHsKICAgIGRhc2hib2FyZDogZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gdGhpcy5pdGVtLnNsdWcgPyB0aGlzLml0ZW0uc2x1ZyA6ICJkZWZhdWx0IjsKICAgIH0sCiAgICBzdGF0dXM6IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKCF0aGlzLmluY2lkZW50KSB7CiAgICAgICAgcmV0dXJuICIiOwogICAgICB9CiAgICAgIHJldHVybiB0aGlzLmluY2lkZW50LmluY2lkZW50ID09IG51bGwgPyB0aGlzLnBhZ2VTdGF0dXMgOiAiYmFkIjsKICAgIH0sCiAgICBsYXN0SGVhcnRCZWF0TGlzdDogZnVuY3Rpb24gKCkgewogICAgICBsZXQgcmVzdWx0ID0ge307CgogICAgICBmb3IgKGxldCBpZCBpbiB0aGlzLmhlYXJ0YmVhdC5oZWFydGJlYXRMaXN0KSB7CiAgICAgICAgbGV0IGluZGV4ID0gdGhpcy5oZWFydGJlYXQuaGVhcnRiZWF0TGlzdFtpZF0ubGVuZ3RoIC0gMTsKICAgICAgICByZXN1bHRbaWRdID0gdGhpcy5oZWFydGJlYXQuaGVhcnRiZWF0TGlzdFtpZF1baW5kZXhdOwogICAgICB9CgogICAgICByZXR1cm4gcmVzdWx0OwogICAgfSwKICAgIHBhZ2VTdGF0dXM6IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKCF0aGlzLmhlYXJ0YmVhdCkgewogICAgICAgIHJldHVybiAiIjsKICAgICAgfQogICAgICBpZiAoT2JqZWN0LmtleXModGhpcy5oZWFydGJlYXQuaGVhcnRiZWF0TGlzdCkubGVuZ3RoID09PSAwKSB7CiAgICAgICAgcmV0dXJuICIiOwogICAgICB9CiAgICAgIGxldCByZXN1bHQgPSAiZ29vZCI7CiAgICAgIGxldCBoYXNVcCA9IGZhbHNlOwogICAgICBmb3IgKGxldCBpZCBpbiB0aGlzLmxhc3RIZWFydEJlYXRMaXN0KSB7CiAgICAgICAgbGV0IGJlYXQgPSB0aGlzLmxhc3RIZWFydEJlYXRMaXN0W2lkXTsKICAgICAgICBpZiAoYmVhdC5zdGF0dXMgPT0gMSkgewogICAgICAgICAgaGFzVXAgPSB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXN1bHQgPSAid2FybiI7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmICghaGFzVXApIHsKICAgICAgICByZXN1bHQgPSAiYmFkIjsKICAgICAgfQogICAgICByZXR1cm4gcmVzdWx0OwogICAgfSwKICAgIHN0YXR1c01lc3NhZ2U6IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKCF0aGlzLmluY2lkZW50KSB7CiAgICAgICAgcmV0dXJuICIiOwogICAgICB9CiAgICAgIGlmICh0aGlzLmluY2lkZW50LmluY2lkZW50KSB7CiAgICAgICAgcmV0dXJuIHRoaXMuaW5jaWRlbnQuaW5jaWRlbnQudGl0bGU7CiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXMucGFnZVN0YXR1cyA9PSAid2FybiIKICAgICAgICA/ICJQYXJ0aWFsbHkgRGVncmFkZWQgU2VydmljZSIKICAgICAgICA6ICJBbGwgU3lzdGVtcyBPcGVyYXRpb25hbCI7CiAgICB9LAogICAgdXB0aW1lOiBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICghdGhpcy5oZWFydGJlYXQpIHsKICAgICAgICByZXR1cm4gMDsKICAgICAgfQogICAgICBjb25zdCBkYXRhID0gT2JqZWN0LnZhbHVlcyh0aGlzLmhlYXJ0YmVhdC51cHRpbWVMaXN0KTsKICAgICAgY29uc3QgcGVyY2VudCA9IGRhdGEucmVkdWNlKChhLCBiKSA9PiBhICsgYiwgMCkgLyBkYXRhLmxlbmd0aCB8fCAwOwogICAgICByZXR1cm4gKHBlcmNlbnQgKiAxMDApLnRvRml4ZWQoMSk7CiAgICB9LAogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuaXRlbS51cmwgPSBgJHt0aGlzLml0ZW0udXJsfS9zdGF0dXMvJHt0aGlzLmRhc2hib2FyZH1gOwogICAgdGhpcy5mZXRjaFN0YXR1cygpOwogIH0sCiAgbWV0aG9kczogewogICAgZmV0Y2hTdGF0dXM6IGZ1bmN0aW9uICgpIHsKICAgICAgdGhpcy5mZXRjaChgL2FwaS9zdGF0dXMtcGFnZS8ke3RoaXMuZGFzaGJvYXJkfT9jYWNoZWJ1c3Q9JHtEYXRlLm5vdygpfWApCiAgICAgICAgLmNhdGNoKChlKSA9PiBjb25zb2xlLmVycm9yKGUpKQogICAgICAgIC50aGVuKChyZXNwKSA9PiAodGhpcy5pbmNpZGVudCA9IHJlc3ApKTsKCiAgICAgIHRoaXMuZmV0Y2goCiAgICAgICAgYC9hcGkvc3RhdHVzLXBhZ2UvaGVhcnRiZWF0LyR7dGhpcy5kYXNoYm9hcmR9P2NhY2hlYnVzdD0ke0RhdGUubm93KCl9YAogICAgICApCiAgICAgICAgLmNhdGNoKChlKSA9PiBjb25zb2xlLmVycm9yKGUpKQogICAgICAgIC50aGVuKChyZXNwKSA9PiAodGhpcy5oZWFydGJlYXQgPSByZXNwKSk7CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["UptimeKuma.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAsBA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"UptimeKuma.vue","sourceRoot":"src/components/services","sourcesContent":["<template>\n  <Generic :item=\"item\">\n    <template #content>\n      <p class=\"title is-4\">{{ item.name }}</p>\n      <p class=\"subtitle is-6\">\n        <template v-if=\"item.subtitle\">\n          {{ item.subtitle }}\n        </template>\n        <template v-else-if=\"status\">\n          {{ statusMessage }}\n        </template>\n      </p>\n    </template>\n    <template #indicator>\n      <div v-if=\"status\" class=\"status\" :class=\"status\">\n        {{ uptime }}&percnt;\n      </div>\n    </template>\n  </Generic>\n</template>\n\n<script>\nimport service from \"@/mixins/service.js\";\nimport Generic from \"./Generic.vue\";\n\nexport default {\n  name: \"UptimeKuma\",\n  mixins: [service],\n  props: {\n    item: Object,\n  },\n  components: {\n    Generic,\n  },\n  data: () => ({\n    incident: null,\n    heartbeat: null,\n  }),\n  computed: {\n    dashboard: function () {\n      return this.item.slug ? this.item.slug : \"default\";\n    },\n    status: function () {\n      if (!this.incident) {\n        return \"\";\n      }\n      return this.incident.incident == null ? this.pageStatus : \"bad\";\n    },\n    lastHeartBeatList: function () {\n      let result = {};\n\n      for (let id in this.heartbeat.heartbeatList) {\n        let index = this.heartbeat.heartbeatList[id].length - 1;\n        result[id] = this.heartbeat.heartbeatList[id][index];\n      }\n\n      return result;\n    },\n    pageStatus: function () {\n      if (!this.heartbeat) {\n        return \"\";\n      }\n      if (Object.keys(this.heartbeat.heartbeatList).length === 0) {\n        return \"\";\n      }\n      let result = \"good\";\n      let hasUp = false;\n      for (let id in this.lastHeartBeatList) {\n        let beat = this.lastHeartBeatList[id];\n        if (beat.status == 1) {\n          hasUp = true;\n        } else {\n          result = \"warn\";\n        }\n      }\n      if (!hasUp) {\n        result = \"bad\";\n      }\n      return result;\n    },\n    statusMessage: function () {\n      if (!this.incident) {\n        return \"\";\n      }\n      if (this.incident.incident) {\n        return this.incident.incident.title;\n      }\n      return this.pageStatus == \"warn\"\n        ? \"Partially Degraded Service\"\n        : \"All Systems Operational\";\n    },\n    uptime: function () {\n      if (!this.heartbeat) {\n        return 0;\n      }\n      const data = Object.values(this.heartbeat.uptimeList);\n      const percent = data.reduce((a, b) => a + b, 0) / data.length || 0;\n      return (percent * 100).toFixed(1);\n    },\n  },\n  created() {\n    this.item.url = `${this.item.url}/status/${this.dashboard}`;\n    this.fetchStatus();\n  },\n  methods: {\n    fetchStatus: function () {\n      this.fetch(`/api/status-page/${this.dashboard}?cachebust=${Date.now()}`)\n        .catch((e) => console.error(e))\n        .then((resp) => (this.incident = resp));\n\n      this.fetch(\n        `/api/status-page/heartbeat/${this.dashboard}?cachebust=${Date.now()}`\n      )\n        .catch((e) => console.error(e))\n        .then((resp) => (this.heartbeat = resp));\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"scss\">\n.status {\n  font-size: 0.8rem;\n  color: var(--text-title);\n\n  &.good:before {\n    background-color: #94e185;\n    border-color: #78d965;\n    box-shadow: 0 0 5px 1px #94e185;\n  }\n\n  &.warn:before {\n    background-color: #f8a306;\n    border-color: #e1b35e;\n    box-shadow: 0 0 5px 1px #f8a306;\n  }\n\n  &.bad:before {\n    background-color: #c9404d;\n    border-color: #c42c3b;\n    box-shadow: 0 0 5px 1px #c9404d;\n  }\n\n  &:before {\n    content: \" \";\n    display: inline-block;\n    width: 7px;\n    height: 7px;\n    margin-right: 10px;\n    border: 1px solid #000;\n    border-radius: 7px;\n  }\n}\n</style>\n"]}]}