{"remainingRequest":"/home/pi/homer/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/pi/homer/src/components/services/Prometheus.vue?vue&type=style&index=0&id=0a5926be&scoped=true&lang=scss&","dependencies":[{"path":"/home/pi/homer/src/components/services/Prometheus.vue","mtime":1654015932568},{"path":"/home/pi/homer/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/pi/homer/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/pi/homer/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/pi/homer/node_modules/sass-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/pi/homer/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/pi/homer/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5tZWRpYS1sZWZ0IHsKICAuaW1hZ2UgewogICAgZGlzcGxheTogZmxleDsKICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgfQoKICBpbWcgewogICAgbWF4LWhlaWdodDogMTAwJTsKICB9Cn0KLnN0YXR1cyB7CiAgZm9udC1zaXplOiAwLjhyZW07CiAgY29sb3I6IHZhcigtLXRleHQtdGl0bGUpOwoKICAmLmZpcmluZzpiZWZvcmUgewogICAgYmFja2dyb3VuZC1jb2xvcjogI2Q2NWM2ODsKICAgIGJvcmRlci1jb2xvcjogI2U4N2Q4ODsKICAgIGJveC1zaGFkb3c6IDAgMCA1cHggMXB4ICNkNjVjNjg7CiAgfQoKICAmLnBlbmRpbmc6YmVmb3JlIHsKICAgIGJhY2tncm91bmQtY29sb3I6ICNlOGJiN2Q7CiAgICBib3JkZXItY29sb3I6ICNkNmEzNWM7CiAgICBib3gtc2hhZG93OiAwIDAgNXB4IDFweCAjZThiYjdkOwogIH0KCiAgJi5pbmFjdGl2ZTpiZWZvcmUgewogICAgYmFja2dyb3VuZC1jb2xvcjogIzhmZTg3ZDsKICAgIGJvcmRlci1jb2xvcjogIzcwZDY1YzsKICAgIGJveC1zaGFkb3c6IDAgMCA1cHggMXB4ICM4ZmU4N2Q7CiAgfQoKICAmOmJlZm9yZSB7CiAgICBjb250ZW50OiAiICI7CiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CiAgICB3aWR0aDogN3B4OwogICAgaGVpZ2h0OiA3cHg7CiAgICBtYXJnaW4tcmlnaHQ6IDEwcHg7CiAgICBib3JkZXI6IDFweCBzb2xpZCAjMDAwOwogICAgYm9yZGVyLXJhZGl1czogN3B4OwogIH0KfQo="},{"version":3,"sources":["Prometheus.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Prometheus.vue","sourceRoot":"src/components/services","sourcesContent":["<template>\n  <Generic :item=\"item\">\n    <template #content>\n      <p class=\"title is-4\">{{ item.name }}</p>\n      <p class=\"subtitle is-6\">\n        <template v-if=\"item.subtitle\">\n          {{ item.subtitle }}\n        </template>\n        <template v-else-if=\"api\"> {{ count }} {{ level }} alerts </template>\n      </p>\n    </template>\n    <template #indicator>\n      <div v-if=\"api\" class=\"status\" :class=\"level\">\n        {{ count }}\n      </div>\n    </template>\n  </Generic>\n</template>\n\n<script>\nimport service from \"@/mixins/service.js\";\nimport Generic from \"./Generic.vue\";\n\nconst AlertsStatus = Object.freeze({\n  firing: \"firing\",\n  pending: \"pending\",\n  inactive: \"inactive\",\n});\n\nexport default {\n  name: \"Prometheus\",\n  mixins: [service],\n  props: {\n    item: Object,\n  },\n  components: {\n    Generic,\n  },\n  data: () => ({\n    api: {\n      status: \"\",\n      count: 0,\n      alerts: {\n        firing: 0,\n        inactive: 0,\n        pending: 0,\n      },\n    },\n  }),\n  computed: {\n    count: function () {\n      return (\n        this.countFiring() || this.countPending() || this.countInactive() || 0\n      );\n    },\n    level: function () {\n      if (this.countFiring()) {\n        return AlertsStatus.firing;\n      } else if (this.countPending()) {\n        return AlertsStatus.pending;\n      }\n      return AlertsStatus.inactive;\n    },\n  },\n  created() {\n    this.fetchStatus();\n  },\n  methods: {\n    fetchStatus: async function () {\n      this.api = await this.fetch(\"api/v1/alerts\").catch((e) => console.log(e));\n    },\n    countFiring: function () {\n      if (this.api) {\n        return this.api.data?.alerts?.filter(\n          (alert) => alert.state === AlertsStatus.firing\n        ).length;\n      }\n      return 0;\n    },\n    countPending: function () {\n      if (this.api) {\n        return this.api.data?.alerts?.filter(\n          (alert) => alert.state === AlertsStatus.pending\n        ).length;\n      }\n      return 0;\n    },\n    countInactive: function () {\n      if (this.api) {\n        return this.api.data?.alerts?.filter(\n          (alert) => alert.state === AlertsStatus.pending\n        ).length;\n      }\n      return 0;\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"scss\">\n.media-left {\n  .image {\n    display: flex;\n    align-items: center;\n  }\n\n  img {\n    max-height: 100%;\n  }\n}\n.status {\n  font-size: 0.8rem;\n  color: var(--text-title);\n\n  &.firing:before {\n    background-color: #d65c68;\n    border-color: #e87d88;\n    box-shadow: 0 0 5px 1px #d65c68;\n  }\n\n  &.pending:before {\n    background-color: #e8bb7d;\n    border-color: #d6a35c;\n    box-shadow: 0 0 5px 1px #e8bb7d;\n  }\n\n  &.inactive:before {\n    background-color: #8fe87d;\n    border-color: #70d65c;\n    box-shadow: 0 0 5px 1px #8fe87d;\n  }\n\n  &:before {\n    content: \" \";\n    display: inline-block;\n    width: 7px;\n    height: 7px;\n    margin-right: 10px;\n    border: 1px solid #000;\n    border-radius: 7px;\n  }\n}\n</style>\n"]}]}