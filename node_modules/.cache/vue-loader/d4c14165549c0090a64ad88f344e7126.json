{"remainingRequest":"/home/pi/homer/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/pi/homer/src/components/services/Portainer.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/pi/homer/src/components/services/Portainer.vue","mtime":1654015932568},{"path":"/home/pi/homer/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/pi/homer/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/pi/homer/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/pi/homer/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/pi/homer/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBzZXJ2aWNlIGZyb20gIkAvbWl4aW5zL3NlcnZpY2UuanMiOwppbXBvcnQgR2VuZXJpYyBmcm9tICIuL0dlbmVyaWMudnVlIjsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiUG9ydGFpbmVyIiwKICBtaXhpbnM6IFtzZXJ2aWNlXSwKICBwcm9wczogewogICAgaXRlbTogT2JqZWN0LAogIH0sCiAgY29tcG9uZW50czogewogICAgR2VuZXJpYywKICB9LAogIGRhdGE6ICgpID0+ICh7CiAgICBlbmRwb2ludHM6IG51bGwsCiAgICBjb250YWluZXJzOiBudWxsLAogIH0pLAogIGNvbXB1dGVkOiB7CiAgICBydW5uaW5nOiBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICghdGhpcy5jb250YWluZXJzKSB7CiAgICAgICAgcmV0dXJuICIiOwogICAgICB9CiAgICAgIHJldHVybiB0aGlzLmNvbnRhaW5lcnMuZmlsdGVyKChjb250YWluZXIpID0+IHsKICAgICAgICByZXR1cm4gY29udGFpbmVyLlN0YXRlLnRvTG93ZXJDYXNlKCkgPT09ICJydW5uaW5nIjsKICAgICAgfSkubGVuZ3RoOwogICAgfSwKICAgIGRlYWQ6IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKCF0aGlzLmNvbnRhaW5lcnMpIHsKICAgICAgICByZXR1cm4gIiI7CiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXMuY29udGFpbmVycy5maWx0ZXIoKGNvbnRhaW5lcikgPT4gewogICAgICAgIHJldHVybiBjb250YWluZXIuU3RhdGUudG9Mb3dlckNhc2UoKSA9PT0gImRlYWQiOwogICAgICB9KS5sZW5ndGg7CiAgICB9LAogICAgbWlzYzogZnVuY3Rpb24gKCkgewogICAgICBpZiAoIXRoaXMuY29udGFpbmVycykgewogICAgICAgIHJldHVybiAiIjsKICAgICAgfQogICAgICByZXR1cm4gdGhpcy5jb250YWluZXJzLmZpbHRlcigoY29udGFpbmVyKSA9PiB7CiAgICAgICAgcmV0dXJuICgKICAgICAgICAgIGNvbnRhaW5lci5TdGF0ZS50b0xvd2VyQ2FzZSgpICE9PSAicnVubmluZyIgJiYKICAgICAgICAgIGNvbnRhaW5lci5TdGF0ZS50b0xvd2VyQ2FzZSgpICE9PSAiZGVhZCIKICAgICAgICApOwogICAgICB9KS5sZW5ndGg7CiAgICB9LAogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuZmV0Y2hTdGF0dXMoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGZldGNoU3RhdHVzOiBhc3luYyBmdW5jdGlvbiAoKSB7CiAgICAgIGNvbnN0IGhlYWRlcnMgPSB7CiAgICAgICAgIlgtQXBpLUtleSI6IHRoaXMuaXRlbS5hcGlrZXksCiAgICAgIH07CgogICAgICB0aGlzLmVuZHBvaW50cyA9IGF3YWl0IHRoaXMuZmV0Y2goIi9hcGkvZW5kcG9pbnRzIiwgeyBoZWFkZXJzIH0pLmNhdGNoKAogICAgICAgIChlKSA9PiB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKGUpOwogICAgICAgIH0KICAgICAgKTsKCiAgICAgIGxldCBjb250YWluZXJzID0gW107CiAgICAgIGZvciAobGV0IGVuZHBvaW50IG9mIHRoaXMuZW5kcG9pbnRzKSB7CiAgICAgICAgaWYgKAogICAgICAgICAgdGhpcy5pdGVtLmVudmlyb25tZW50cyAmJgogICAgICAgICAgIXRoaXMuaXRlbS5lbnZpcm9ubWVudHMuaW5jbHVkZXMoZW5kcG9pbnQuTmFtZSkKICAgICAgICApIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KICAgICAgICBjb25zdCB1cmkgPSBgL2FwaS9lbmRwb2ludHMvJHtlbmRwb2ludC5JZH0vZG9ja2VyL2NvbnRhaW5lcnMvanNvbj9hbGw9MWA7CiAgICAgICAgY29uc3QgZW5kcG9pbnRDb250YWluZXJzID0gYXdhaXQgdGhpcy5mZXRjaCh1cmksIHsgaGVhZGVycyB9KS5jYXRjaCgKICAgICAgICAgIChlKSA9PiB7CiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZSk7CiAgICAgICAgICB9CiAgICAgICAgKTsKCiAgICAgICAgaWYgKGVuZHBvaW50Q29udGFpbmVycykgewogICAgICAgICAgY29udGFpbmVycyA9IGNvbnRhaW5lcnMuY29uY2F0KGVuZHBvaW50Q29udGFpbmVycyk7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmNvbnRhaW5lcnMgPSBjb250YWluZXJzOwogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["Portainer.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAuBA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"Portainer.vue","sourceRoot":"src/components/services","sourcesContent":["<template>\n  <Generic :item=\"item\">\n    <template #indicator>\n      <div class=\"notifs\">\n        <strong v-if=\"running > 0\" class=\"notif running\" title=\"Running\">\n          {{ running }}\n        </strong>\n        <strong v-if=\"dead > 0\" class=\"notif dead\" title=\"Dead\">\n          {{ dead }}\n        </strong>\n        <strong\n          v-if=\"misc > 0\"\n          class=\"notif misc\"\n          title=\"Other (creating, paused, exited, etc.)\"\n        >\n          {{ misc }}\n        </strong>\n      </div>\n    </template>\n  </Generic>\n</template>\n\n<script>\nimport service from \"@/mixins/service.js\";\nimport Generic from \"./Generic.vue\";\n\nexport default {\n  name: \"Portainer\",\n  mixins: [service],\n  props: {\n    item: Object,\n  },\n  components: {\n    Generic,\n  },\n  data: () => ({\n    endpoints: null,\n    containers: null,\n  }),\n  computed: {\n    running: function () {\n      if (!this.containers) {\n        return \"\";\n      }\n      return this.containers.filter((container) => {\n        return container.State.toLowerCase() === \"running\";\n      }).length;\n    },\n    dead: function () {\n      if (!this.containers) {\n        return \"\";\n      }\n      return this.containers.filter((container) => {\n        return container.State.toLowerCase() === \"dead\";\n      }).length;\n    },\n    misc: function () {\n      if (!this.containers) {\n        return \"\";\n      }\n      return this.containers.filter((container) => {\n        return (\n          container.State.toLowerCase() !== \"running\" &&\n          container.State.toLowerCase() !== \"dead\"\n        );\n      }).length;\n    },\n  },\n  created() {\n    this.fetchStatus();\n  },\n  methods: {\n    fetchStatus: async function () {\n      const headers = {\n        \"X-Api-Key\": this.item.apikey,\n      };\n\n      this.endpoints = await this.fetch(\"/api/endpoints\", { headers }).catch(\n        (e) => {\n          console.error(e);\n        }\n      );\n\n      let containers = [];\n      for (let endpoint of this.endpoints) {\n        if (\n          this.item.environments &&\n          !this.item.environments.includes(endpoint.Name)\n        ) {\n          continue;\n        }\n        const uri = `/api/endpoints/${endpoint.Id}/docker/containers/json?all=1`;\n        const endpointContainers = await this.fetch(uri, { headers }).catch(\n          (e) => {\n            console.error(e);\n          }\n        );\n\n        if (endpointContainers) {\n          containers = containers.concat(endpointContainers);\n        }\n      }\n\n      this.containers = containers;\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"scss\">\n.notifs {\n  position: absolute;\n  color: white;\n  font-family: sans-serif;\n  top: 0.3em;\n  right: 0.5em;\n\n  .notif {\n    display: inline-block;\n    padding: 0.2em 0.35em;\n    border-radius: 0.25em;\n    position: relative;\n    margin-left: 0.3em;\n    font-size: 0.8em;\n\n    &.running {\n      background-color: #4fd671;\n    }\n\n    &.dead {\n      background-color: #e51111;\n    }\n\n    &.misc {\n      background-color: #2ed0c8;\n    }\n  }\n}\n</style>\n"]}]}