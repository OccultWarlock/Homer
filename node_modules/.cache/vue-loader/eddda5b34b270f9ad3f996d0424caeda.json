{"remainingRequest":"/home/pi/homer/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/pi/homer/src/components/services/Prometheus.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/pi/homer/src/components/services/Prometheus.vue","mtime":1654015932568},{"path":"/home/pi/homer/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/pi/homer/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/pi/homer/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/pi/homer/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/pi/homer/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBzZXJ2aWNlIGZyb20gIkAvbWl4aW5zL3NlcnZpY2UuanMiOwppbXBvcnQgR2VuZXJpYyBmcm9tICIuL0dlbmVyaWMudnVlIjsKCmNvbnN0IEFsZXJ0c1N0YXR1cyA9IE9iamVjdC5mcmVlemUoewogIGZpcmluZzogImZpcmluZyIsCiAgcGVuZGluZzogInBlbmRpbmciLAogIGluYWN0aXZlOiAiaW5hY3RpdmUiLAp9KTsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiUHJvbWV0aGV1cyIsCiAgbWl4aW5zOiBbc2VydmljZV0sCiAgcHJvcHM6IHsKICAgIGl0ZW06IE9iamVjdCwKICB9LAogIGNvbXBvbmVudHM6IHsKICAgIEdlbmVyaWMsCiAgfSwKICBkYXRhOiAoKSA9PiAoewogICAgYXBpOiB7CiAgICAgIHN0YXR1czogIiIsCiAgICAgIGNvdW50OiAwLAogICAgICBhbGVydHM6IHsKICAgICAgICBmaXJpbmc6IDAsCiAgICAgICAgaW5hY3RpdmU6IDAsCiAgICAgICAgcGVuZGluZzogMCwKICAgICAgfSwKICAgIH0sCiAgfSksCiAgY29tcHV0ZWQ6IHsKICAgIGNvdW50OiBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiAoCiAgICAgICAgdGhpcy5jb3VudEZpcmluZygpIHx8IHRoaXMuY291bnRQZW5kaW5nKCkgfHwgdGhpcy5jb3VudEluYWN0aXZlKCkgfHwgMAogICAgICApOwogICAgfSwKICAgIGxldmVsOiBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICh0aGlzLmNvdW50RmlyaW5nKCkpIHsKICAgICAgICByZXR1cm4gQWxlcnRzU3RhdHVzLmZpcmluZzsKICAgICAgfSBlbHNlIGlmICh0aGlzLmNvdW50UGVuZGluZygpKSB7CiAgICAgICAgcmV0dXJuIEFsZXJ0c1N0YXR1cy5wZW5kaW5nOwogICAgICB9CiAgICAgIHJldHVybiBBbGVydHNTdGF0dXMuaW5hY3RpdmU7CiAgICB9LAogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuZmV0Y2hTdGF0dXMoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGZldGNoU3RhdHVzOiBhc3luYyBmdW5jdGlvbiAoKSB7CiAgICAgIHRoaXMuYXBpID0gYXdhaXQgdGhpcy5mZXRjaCgiYXBpL3YxL2FsZXJ0cyIpLmNhdGNoKChlKSA9PiBjb25zb2xlLmxvZyhlKSk7CiAgICB9LAogICAgY291bnRGaXJpbmc6IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKHRoaXMuYXBpKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuYXBpLmRhdGE/LmFsZXJ0cz8uZmlsdGVyKAogICAgICAgICAgKGFsZXJ0KSA9PiBhbGVydC5zdGF0ZSA9PT0gQWxlcnRzU3RhdHVzLmZpcmluZwogICAgICAgICkubGVuZ3RoOwogICAgICB9CiAgICAgIHJldHVybiAwOwogICAgfSwKICAgIGNvdW50UGVuZGluZzogZnVuY3Rpb24gKCkgewogICAgICBpZiAodGhpcy5hcGkpIHsKICAgICAgICByZXR1cm4gdGhpcy5hcGkuZGF0YT8uYWxlcnRzPy5maWx0ZXIoCiAgICAgICAgICAoYWxlcnQpID0+IGFsZXJ0LnN0YXRlID09PSBBbGVydHNTdGF0dXMucGVuZGluZwogICAgICAgICkubGVuZ3RoOwogICAgICB9CiAgICAgIHJldHVybiAwOwogICAgfSwKICAgIGNvdW50SW5hY3RpdmU6IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKHRoaXMuYXBpKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuYXBpLmRhdGE/LmFsZXJ0cz8uZmlsdGVyKAogICAgICAgICAgKGFsZXJ0KSA9PiBhbGVydC5zdGF0ZSA9PT0gQWxlcnRzU3RhdHVzLnBlbmRpbmcKICAgICAgICApLmxlbmd0aDsKICAgICAgfQogICAgICByZXR1cm4gMDsKICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["Prometheus.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAoBA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Prometheus.vue","sourceRoot":"src/components/services","sourcesContent":["<template>\n  <Generic :item=\"item\">\n    <template #content>\n      <p class=\"title is-4\">{{ item.name }}</p>\n      <p class=\"subtitle is-6\">\n        <template v-if=\"item.subtitle\">\n          {{ item.subtitle }}\n        </template>\n        <template v-else-if=\"api\"> {{ count }} {{ level }} alerts </template>\n      </p>\n    </template>\n    <template #indicator>\n      <div v-if=\"api\" class=\"status\" :class=\"level\">\n        {{ count }}\n      </div>\n    </template>\n  </Generic>\n</template>\n\n<script>\nimport service from \"@/mixins/service.js\";\nimport Generic from \"./Generic.vue\";\n\nconst AlertsStatus = Object.freeze({\n  firing: \"firing\",\n  pending: \"pending\",\n  inactive: \"inactive\",\n});\n\nexport default {\n  name: \"Prometheus\",\n  mixins: [service],\n  props: {\n    item: Object,\n  },\n  components: {\n    Generic,\n  },\n  data: () => ({\n    api: {\n      status: \"\",\n      count: 0,\n      alerts: {\n        firing: 0,\n        inactive: 0,\n        pending: 0,\n      },\n    },\n  }),\n  computed: {\n    count: function () {\n      return (\n        this.countFiring() || this.countPending() || this.countInactive() || 0\n      );\n    },\n    level: function () {\n      if (this.countFiring()) {\n        return AlertsStatus.firing;\n      } else if (this.countPending()) {\n        return AlertsStatus.pending;\n      }\n      return AlertsStatus.inactive;\n    },\n  },\n  created() {\n    this.fetchStatus();\n  },\n  methods: {\n    fetchStatus: async function () {\n      this.api = await this.fetch(\"api/v1/alerts\").catch((e) => console.log(e));\n    },\n    countFiring: function () {\n      if (this.api) {\n        return this.api.data?.alerts?.filter(\n          (alert) => alert.state === AlertsStatus.firing\n        ).length;\n      }\n      return 0;\n    },\n    countPending: function () {\n      if (this.api) {\n        return this.api.data?.alerts?.filter(\n          (alert) => alert.state === AlertsStatus.pending\n        ).length;\n      }\n      return 0;\n    },\n    countInactive: function () {\n      if (this.api) {\n        return this.api.data?.alerts?.filter(\n          (alert) => alert.state === AlertsStatus.pending\n        ).length;\n      }\n      return 0;\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"scss\">\n.media-left {\n  .image {\n    display: flex;\n    align-items: center;\n  }\n\n  img {\n    max-height: 100%;\n  }\n}\n.status {\n  font-size: 0.8rem;\n  color: var(--text-title);\n\n  &.firing:before {\n    background-color: #d65c68;\n    border-color: #e87d88;\n    box-shadow: 0 0 5px 1px #d65c68;\n  }\n\n  &.pending:before {\n    background-color: #e8bb7d;\n    border-color: #d6a35c;\n    box-shadow: 0 0 5px 1px #e8bb7d;\n  }\n\n  &.inactive:before {\n    background-color: #8fe87d;\n    border-color: #70d65c;\n    box-shadow: 0 0 5px 1px #8fe87d;\n  }\n\n  &:before {\n    content: \" \";\n    display: inline-block;\n    width: 7px;\n    height: 7px;\n    margin-right: 10px;\n    border: 1px solid #000;\n    border-radius: 7px;\n  }\n}\n</style>\n"]}]}