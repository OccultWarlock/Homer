{"remainingRequest":"/home/pi/homer/node_modules/thread-loader/dist/cjs.js!/home/pi/homer/node_modules/babel-loader/lib/index.js!/home/pi/homer/node_modules/cache-loader/dist/cjs.js??ref--1-0!/home/pi/homer/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/pi/homer/src/components/services/Prometheus.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/pi/homer/src/components/services/Prometheus.vue","mtime":1654015932568},{"path":"/home/pi/homer/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/pi/homer/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/pi/homer/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/pi/homer/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/pi/homer/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9ob21lL3BpL2hvbWVyL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZnJlZXplLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyLmpzIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IHNlcnZpY2UgZnJvbSAiQC9taXhpbnMvc2VydmljZS5qcyI7CmltcG9ydCBHZW5lcmljIGZyb20gIi4vR2VuZXJpYy52dWUiOwp2YXIgQWxlcnRzU3RhdHVzID0gT2JqZWN0LmZyZWV6ZSh7CiAgZmlyaW5nOiAiZmlyaW5nIiwKICBwZW5kaW5nOiAicGVuZGluZyIsCiAgaW5hY3RpdmU6ICJpbmFjdGl2ZSIKfSk7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiUHJvbWV0aGV1cyIsCiAgbWl4aW5zOiBbc2VydmljZV0sCiAgcHJvcHM6IHsKICAgIGl0ZW06IE9iamVjdAogIH0sCiAgY29tcG9uZW50czogewogICAgR2VuZXJpYzogR2VuZXJpYwogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGFwaTogewogICAgICAgIHN0YXR1czogIiIsCiAgICAgICAgY291bnQ6IDAsCiAgICAgICAgYWxlcnRzOiB7CiAgICAgICAgICBmaXJpbmc6IDAsCiAgICAgICAgICBpbmFjdGl2ZTogMCwKICAgICAgICAgIHBlbmRpbmc6IDAKICAgICAgICB9CiAgICAgIH0KICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgY291bnQ6IGZ1bmN0aW9uIGNvdW50KCkgewogICAgICByZXR1cm4gdGhpcy5jb3VudEZpcmluZygpIHx8IHRoaXMuY291bnRQZW5kaW5nKCkgfHwgdGhpcy5jb3VudEluYWN0aXZlKCkgfHwgMDsKICAgIH0sCiAgICBsZXZlbDogZnVuY3Rpb24gbGV2ZWwoKSB7CiAgICAgIGlmICh0aGlzLmNvdW50RmlyaW5nKCkpIHsKICAgICAgICByZXR1cm4gQWxlcnRzU3RhdHVzLmZpcmluZzsKICAgICAgfSBlbHNlIGlmICh0aGlzLmNvdW50UGVuZGluZygpKSB7CiAgICAgICAgcmV0dXJuIEFsZXJ0c1N0YXR1cy5wZW5kaW5nOwogICAgICB9CgogICAgICByZXR1cm4gQWxlcnRzU3RhdHVzLmluYWN0aXZlOwogICAgfQogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHRoaXMuZmV0Y2hTdGF0dXMoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGZldGNoU3RhdHVzOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfZmV0Y2hTdGF0dXMgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5mZXRjaCgiYXBpL3YxL2FsZXJ0cyIpLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBjb25zb2xlLmxvZyhlKTsKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICB0aGlzLmFwaSA9IF9jb250ZXh0LnNlbnQ7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBmZXRjaFN0YXR1cygpIHsKICAgICAgICByZXR1cm4gX2ZldGNoU3RhdHVzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBmZXRjaFN0YXR1czsKICAgIH0oKSwKICAgIGNvdW50RmlyaW5nOiBmdW5jdGlvbiBjb3VudEZpcmluZygpIHsKICAgICAgaWYgKHRoaXMuYXBpKSB7CiAgICAgICAgdmFyIF90aGlzJGFwaSRkYXRhLCBfdGhpcyRhcGkkZGF0YSRhbGVydHM7CgogICAgICAgIHJldHVybiAoX3RoaXMkYXBpJGRhdGEgPSB0aGlzLmFwaS5kYXRhKSA9PT0gbnVsbCB8fCBfdGhpcyRhcGkkZGF0YSA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF90aGlzJGFwaSRkYXRhJGFsZXJ0cyA9IF90aGlzJGFwaSRkYXRhLmFsZXJ0cykgPT09IG51bGwgfHwgX3RoaXMkYXBpJGRhdGEkYWxlcnRzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRhcGkkZGF0YSRhbGVydHMuZmlsdGVyKGZ1bmN0aW9uIChhbGVydCkgewogICAgICAgICAgcmV0dXJuIGFsZXJ0LnN0YXRlID09PSBBbGVydHNTdGF0dXMuZmlyaW5nOwogICAgICAgIH0pLmxlbmd0aDsKICAgICAgfQoKICAgICAgcmV0dXJuIDA7CiAgICB9LAogICAgY291bnRQZW5kaW5nOiBmdW5jdGlvbiBjb3VudFBlbmRpbmcoKSB7CiAgICAgIGlmICh0aGlzLmFwaSkgewogICAgICAgIHZhciBfdGhpcyRhcGkkZGF0YTIsIF90aGlzJGFwaSRkYXRhMiRhbGVydDsKCiAgICAgICAgcmV0dXJuIChfdGhpcyRhcGkkZGF0YTIgPSB0aGlzLmFwaS5kYXRhKSA9PT0gbnVsbCB8fCBfdGhpcyRhcGkkZGF0YTIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfdGhpcyRhcGkkZGF0YTIkYWxlcnQgPSBfdGhpcyRhcGkkZGF0YTIuYWxlcnRzKSA9PT0gbnVsbCB8fCBfdGhpcyRhcGkkZGF0YTIkYWxlcnQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJGFwaSRkYXRhMiRhbGVydC5maWx0ZXIoZnVuY3Rpb24gKGFsZXJ0KSB7CiAgICAgICAgICByZXR1cm4gYWxlcnQuc3RhdGUgPT09IEFsZXJ0c1N0YXR1cy5wZW5kaW5nOwogICAgICAgIH0pLmxlbmd0aDsKICAgICAgfQoKICAgICAgcmV0dXJuIDA7CiAgICB9LAogICAgY291bnRJbmFjdGl2ZTogZnVuY3Rpb24gY291bnRJbmFjdGl2ZSgpIHsKICAgICAgaWYgKHRoaXMuYXBpKSB7CiAgICAgICAgdmFyIF90aGlzJGFwaSRkYXRhMywgX3RoaXMkYXBpJGRhdGEzJGFsZXJ0OwoKICAgICAgICByZXR1cm4gKF90aGlzJGFwaSRkYXRhMyA9IHRoaXMuYXBpLmRhdGEpID09PSBudWxsIHx8IF90aGlzJGFwaSRkYXRhMyA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF90aGlzJGFwaSRkYXRhMyRhbGVydCA9IF90aGlzJGFwaSRkYXRhMy5hbGVydHMpID09PSBudWxsIHx8IF90aGlzJGFwaSRkYXRhMyRhbGVydCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkYXBpJGRhdGEzJGFsZXJ0LmZpbHRlcihmdW5jdGlvbiAoYWxlcnQpIHsKICAgICAgICAgIHJldHVybiBhbGVydC5zdGF0ZSA9PT0gQWxlcnRzU3RhdHVzLnBlbmRpbmc7CiAgICAgICAgfSkubGVuZ3RoOwogICAgICB9CgogICAgICByZXR1cm4gMDsKICAgIH0KICB9Cn07"},{"version":3,"sources":["Prometheus.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAoBA,OAAA,OAAA,MAAA,qBAAA;AACA,OAAA,OAAA,MAAA,eAAA;AAEA,IAAA,YAAA,GAAA,MAAA,CAAA,MAAA,CAAA;AACA,EAAA,MAAA,EAAA,QADA;AAEA,EAAA,OAAA,EAAA,SAFA;AAGA,EAAA,QAAA,EAAA;AAHA,CAAA,CAAA;AAMA,eAAA;AACA,EAAA,IAAA,EAAA,YADA;AAEA,EAAA,MAAA,EAAA,CAAA,OAAA,CAFA;AAGA,EAAA,KAAA,EAAA;AACA,IAAA,IAAA,EAAA;AADA,GAHA;AAMA,EAAA,UAAA,EAAA;AACA,IAAA,OAAA,EAAA;AADA,GANA;AASA,EAAA,IAAA,EAAA;AAAA,WAAA;AACA,MAAA,GAAA,EAAA;AACA,QAAA,MAAA,EAAA,EADA;AAEA,QAAA,KAAA,EAAA,CAFA;AAGA,QAAA,MAAA,EAAA;AACA,UAAA,MAAA,EAAA,CADA;AAEA,UAAA,QAAA,EAAA,CAFA;AAGA,UAAA,OAAA,EAAA;AAHA;AAHA;AADA,KAAA;AAAA,GATA;AAoBA,EAAA,QAAA,EAAA;AACA,IAAA,KAAA,EAAA,iBAAA;AACA,aACA,KAAA,WAAA,MAAA,KAAA,YAAA,EAAA,IAAA,KAAA,aAAA,EAAA,IAAA,CADA;AAGA,KALA;AAMA,IAAA,KAAA,EAAA,iBAAA;AACA,UAAA,KAAA,WAAA,EAAA,EAAA;AACA,eAAA,YAAA,CAAA,MAAA;AACA,OAFA,MAEA,IAAA,KAAA,YAAA,EAAA,EAAA;AACA,eAAA,YAAA,CAAA,OAAA;AACA;;AACA,aAAA,YAAA,CAAA,QAAA;AACA;AAbA,GApBA;AAmCA,EAAA,OAnCA,qBAmCA;AACA,SAAA,WAAA;AACA,GArCA;AAsCA,EAAA,OAAA,EAAA;AACA,IAAA,WAAA;AAAA,iFAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBACA,KAAA,KAAA,CAAA,eAAA,EAAA,KAAA,CAAA,UAAA,CAAA;AAAA,yBAAA,OAAA,CAAA,GAAA,CAAA,CAAA,CAAA;AAAA,iBAAA,CADA;;AAAA;AACA,qBAAA,GADA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA,OADA;AAIA,IAAA,WAAA,EAAA,uBAAA;AACA,UAAA,KAAA,GAAA,EAAA;AAAA;;AACA,iCAAA,KAAA,GAAA,CAAA,IAAA,4EAAA,eAAA,MAAA,0DAAA,sBAAA,MAAA,CACA,UAAA,KAAA;AAAA,iBAAA,KAAA,CAAA,KAAA,KAAA,YAAA,CAAA,MAAA;AAAA,SADA,EAEA,MAFA;AAGA;;AACA,aAAA,CAAA;AACA,KAXA;AAYA,IAAA,YAAA,EAAA,wBAAA;AACA,UAAA,KAAA,GAAA,EAAA;AAAA;;AACA,kCAAA,KAAA,GAAA,CAAA,IAAA,6EAAA,gBAAA,MAAA,0DAAA,sBAAA,MAAA,CACA,UAAA,KAAA;AAAA,iBAAA,KAAA,CAAA,KAAA,KAAA,YAAA,CAAA,OAAA;AAAA,SADA,EAEA,MAFA;AAGA;;AACA,aAAA,CAAA;AACA,KAnBA;AAoBA,IAAA,aAAA,EAAA,yBAAA;AACA,UAAA,KAAA,GAAA,EAAA;AAAA;;AACA,kCAAA,KAAA,GAAA,CAAA,IAAA,6EAAA,gBAAA,MAAA,0DAAA,sBAAA,MAAA,CACA,UAAA,KAAA;AAAA,iBAAA,KAAA,CAAA,KAAA,KAAA,YAAA,CAAA,OAAA;AAAA,SADA,EAEA,MAFA;AAGA;;AACA,aAAA,CAAA;AACA;AA3BA;AAtCA,CAAA","sourcesContent":["<template>\n  <Generic :item=\"item\">\n    <template #content>\n      <p class=\"title is-4\">{{ item.name }}</p>\n      <p class=\"subtitle is-6\">\n        <template v-if=\"item.subtitle\">\n          {{ item.subtitle }}\n        </template>\n        <template v-else-if=\"api\"> {{ count }} {{ level }} alerts </template>\n      </p>\n    </template>\n    <template #indicator>\n      <div v-if=\"api\" class=\"status\" :class=\"level\">\n        {{ count }}\n      </div>\n    </template>\n  </Generic>\n</template>\n\n<script>\nimport service from \"@/mixins/service.js\";\nimport Generic from \"./Generic.vue\";\n\nconst AlertsStatus = Object.freeze({\n  firing: \"firing\",\n  pending: \"pending\",\n  inactive: \"inactive\",\n});\n\nexport default {\n  name: \"Prometheus\",\n  mixins: [service],\n  props: {\n    item: Object,\n  },\n  components: {\n    Generic,\n  },\n  data: () => ({\n    api: {\n      status: \"\",\n      count: 0,\n      alerts: {\n        firing: 0,\n        inactive: 0,\n        pending: 0,\n      },\n    },\n  }),\n  computed: {\n    count: function () {\n      return (\n        this.countFiring() || this.countPending() || this.countInactive() || 0\n      );\n    },\n    level: function () {\n      if (this.countFiring()) {\n        return AlertsStatus.firing;\n      } else if (this.countPending()) {\n        return AlertsStatus.pending;\n      }\n      return AlertsStatus.inactive;\n    },\n  },\n  created() {\n    this.fetchStatus();\n  },\n  methods: {\n    fetchStatus: async function () {\n      this.api = await this.fetch(\"api/v1/alerts\").catch((e) => console.log(e));\n    },\n    countFiring: function () {\n      if (this.api) {\n        return this.api.data?.alerts?.filter(\n          (alert) => alert.state === AlertsStatus.firing\n        ).length;\n      }\n      return 0;\n    },\n    countPending: function () {\n      if (this.api) {\n        return this.api.data?.alerts?.filter(\n          (alert) => alert.state === AlertsStatus.pending\n        ).length;\n      }\n      return 0;\n    },\n    countInactive: function () {\n      if (this.api) {\n        return this.api.data?.alerts?.filter(\n          (alert) => alert.state === AlertsStatus.pending\n        ).length;\n      }\n      return 0;\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"scss\">\n.media-left {\n  .image {\n    display: flex;\n    align-items: center;\n  }\n\n  img {\n    max-height: 100%;\n  }\n}\n.status {\n  font-size: 0.8rem;\n  color: var(--text-title);\n\n  &.firing:before {\n    background-color: #d65c68;\n    border-color: #e87d88;\n    box-shadow: 0 0 5px 1px #d65c68;\n  }\n\n  &.pending:before {\n    background-color: #e8bb7d;\n    border-color: #d6a35c;\n    box-shadow: 0 0 5px 1px #e8bb7d;\n  }\n\n  &.inactive:before {\n    background-color: #8fe87d;\n    border-color: #70d65c;\n    box-shadow: 0 0 5px 1px #8fe87d;\n  }\n\n  &:before {\n    content: \" \";\n    display: inline-block;\n    width: 7px;\n    height: 7px;\n    margin-right: 10px;\n    border: 1px solid #000;\n    border-radius: 7px;\n  }\n}\n</style>\n"],"sourceRoot":"src/components/services"}]}